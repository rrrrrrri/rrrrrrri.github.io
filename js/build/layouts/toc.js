import{initTocToggle as e}from"../tools/tocToggle.js";import{main as t}from"../main.js";function initTOC(){let o={navItems:document.querySelectorAll(".post-toc-wrap .post-toc li"),updateActiveTOCLink(){if(Array.isArray(o.sections)){let e=o.sections.findIndex(e=>e&&0<e.getBoundingClientRect().top-100);-1===e?e=o.sections.length-1:0<e&&e--,this.activateTOCLink(e)}},registerTOCScroll(){o.sections=[...document.querySelectorAll(".post-toc li a.nav-link")].map(e=>document.getElementById(decodeURI(e.getAttribute("href")).replace("#","")))},activateTOCLink(e){var t,o,n,e=document.querySelectorAll(".post-toc li a.nav-link")[e];e&&!e.classList.contains("active-current")&&(document.querySelectorAll(".post-toc .active").forEach(e=>{e.classList.remove("active","active-current")}),e.classList.add("active","active-current"),n=(t=document.querySelector(".toc-content-container")).getBoundingClientRect().top,o=t.offsetHeight>window.innerHeight?(t.offsetHeight-window.innerHeight)/2:0,n=e.getBoundingClientRect().top-n-Math.max(document.documentElement.clientHeight,window.innerHeight||0)/2+e.offsetHeight/2-o,e=t.scrollTop+n,t.scrollTo({top:e,behavior:"smooth"}))},showTOCAside(){var o=()=>{var o=t.getStyleStatus(),n="isOpenPageAside";o&&o.hasOwnProperty(n)?e().pageAsideHandleOfTOC(o[n]):e().pageAsideHandleOfTOC(!0)},n="init_open";!theme.articles.toc.hasOwnProperty(n)||theme.articles.toc[n]?o():e().pageAsideHandleOfTOC(!1)}};return 0<o.navItems.length?(o.showTOCAside(),o.registerTOCScroll()):document.querySelectorAll(".toc-content-container, .toc-marker").forEach(e=>{e.remove()}),o}try{swup.hooks.on("page:view",()=>{initTOC()})}catch(e){}document.addEventListener("DOMContentLoaded",initTOC);export{initTOC};